FROM tensorflow/tensorflow:1.12.0-gpu-py3

RUN apt-get update && apt-get upgrade -y
RUN add-apt-repository ppa:deadsnakes/ppa -y && \
    apt-get update && \
    apt-get install -y python3.6 python3.6-dev python3.6-tk && \
    apt-get install -y libsm6 libxext6 libxrender1 libfontconfig1 && \
    update-alternatives --install /usr/bin/python python /usr/bin/python3.5 1 && \
    update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2 && \
    update-alternatives  --set python /usr/bin/python3.6

RUN apt-get install -y git 
RUN cd / && git clone https://yoel_m2l:m2ljou722@bitbucket.org/machine2learn/easyai.git
RUN curl https://bootstrap.pypa.io/get-pip.py | python3.6
WORKDIR /easyai
RUN pip3.6 install -r requirements.txt
RUN pip3.6 uninstall --yes tensorflow
RUN sed -i 's/tensorflow=/tensorflow-gpu=/' requirements.txt
RUN grep tensorflow-gpu= requirements.txt | xargs pip install
